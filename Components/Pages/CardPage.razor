@using MTG.Services
@rendermode InteractiveServer
@using System.Linq
@page "/Card/{searchString}"

<h1>Card Page for @searchString</h1>
<div class="card-display">
    @if (selectedCard != null)
    {
        <img src="@selectedCard.Image" />
        <h3>@selectedCard.Name @selectedCard.CardCost</h3>
        <p>@selectedCard.CardText</p>
    }
</div>

<ul class="card-list">
    @foreach (Services.CardModel card in myCards)
    {
        <li @onclick="() => SelectCard(card)">
            @card.Name @card.SetCode
        </li>
    }
</ul>


@code
{
    IQueryable<Services.CardModel> myCards;
    Services services = new Services();
    [Parameter] public string? searchString { get; set; }
    int cardNumber;
    private Services.CardModel selectedCard;
    private void SelectCard(Services.CardModel card)
    {
        selectedCard = card;
    }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        myCards = services.GetCardsByName(searchString);
        selectedCard = myCards.FirstOrDefault();
    }


}
